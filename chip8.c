#include <string.h>
#include <stdio.h>
#include "chip8.h"

unsigned char sprites[80] = {
    0xf0, 0x90, 0x90, 0x90, 0xf0, // 0
    0x20, 0x60, 0x20, 0x20, 0x70, // 1
    0xf0, 0x10, 0xf0, 0x80, 0xf0, // 2
    0xf0, 0x10, 0xf0, 0x10, 0xf0, // 3
    0x90, 0x90, 0xf0, 0x10, 0x10, // 4
    0xf0, 0x80, 0xf0, 0x10, 0x40, // 5
    0xf0, 0x80, 0xf0, 0x90, 0xf0, // 6
    0xf0, 0x10, 0x20, 0x40, 0x40, // 7
    0xf0, 0x90, 0xf0, 0x90, 0xf0, // 8
    0xf0, 0x90, 0xf0, 0x10, 0xf0, // 9
    0xf0, 0x90, 0xf0, 0x90, 0x90, // A
    0xe0, 0x90, 0xe0, 0x90, 0xe0, // B
    0xf0, 0x80, 0x80, 0x80, 0xf0, // C
    0xe0, 0x90, 0x90, 0x90, 0xe0, // D
    0xf0, 0x80, 0xf0, 0x80, 0xf0, // E
    0xf0, 0x80, 0xf0, 0x80, 0x80, // F
};

// initialize all variables
void initialize(chip8_t *chip8) {
    chip8->PC = 0x200;	// all chip8 programs start at 0x200, so set PC to point in that address
    chip8->I = 0;
    chip8->SP = 0;
    chip8->delay_timer = 0;
    chip8->sound_timer = 0;
    chip8->opcode = 0;

    // load fontset on memory
    memcpy(&chip8->memory[0x000], sprites, sizeof(sprites));

    memset(&chip8->V, 0, sizeof(chip8->V));
    memset(&chip8->stack, 0, sizeof(chip8->stack));
    memset(&chip8->screen, 0, sizeof(chip8->screen));
}

// in a cycle the system should:
// 1.- fetch
// 2.- decode
// 3.- execute
void emulateCycle(chip8_t *chip8) {
    //printf("mem index: %04hu - index hex value: 0x%04hX\n", chip8->PC, chip8->PC);
    printf("mem index: %hu - index hex value: 0x%hx\n", chip8->PC, chip8->PC);
    //chip8->opcode = chip8->memory[chip8->PC];
    //printf("%hu\n", chip8->opcode);
}
